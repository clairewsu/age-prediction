adsp=read.csv("adsp_model_predictions.csv")
adspall=read.csv("../../data2_prediction.csv")
library(dplyr)
adsp=inner_join(adsp,adspall)
library(ggpubr)
ggboxplot(data=adsp,y="realdiff")
ggboxplot(data=adsp,x="PHC_Diagnosis.x",y="realdiff")
adsp%>%group_by(PHC_Diagnosis.x)%>%summarise(mean=formatC(mean(realdiff),digits=4))
cog=read.csv("../../data1_cogn.csv")
adsp1=inner_join(adsp,cog,by="FSID")
library(lmerTest)
m=lmer(PHC_MEM~PHC_Sex.x+PHC_Education.x+actual+realdiff+(1|SUBJID),data=adsp1)
m=lmer(PHC_MEM~PHC_Sex.x+PHC_Education.x+actual+realdiff+(1|SUBJID.x),data=adsp1)
summary(m)
summary(m)$coefficients
m=lmer(PHC_LAN~PHC_Sex.x+PHC_Education.x+actual+realdiff+(1|SUBJID.x),data=adsp1)
summary(m)$coefficients
ggplot()+geom_line(data=adsp1,aes(x=realdiff,y=PHC_MEM,group=as.factor(SUBJID.x)))

adsp=read.csv("adsp_model_predictions.csv")
adspall=read.csv("../../ADSP-PHC-T1-FS_DS_2024.12.16.v2_ALL.age_converted.csv")
adspall$FSID=paste(adspall$SUBJID,adspall$PHC_Visit,sep="-")
adni=subset(adspall,Study=="ADNI")
adsp1=inner_join(adsp,adni,by=c("FSID","actual"="PHC_Age_T1"))
bad=subset(as.data.frame(table(adsp1$FSID)),Freq>1)
subset(adsp1,FSID%in%bad$Var1)
ggboxplot(data=adsp1,x="PHC_Diagnosis",y="realdiff")
adsp1%>%group_by(PHC_Diagnosis)%>%summarise(mean=formatC(mean(realdiff)))

pred=read.csv(file="adsp_model_predictions.csv")
pred=inner_join(pred,adspall,by=c("FSID","actual"="PHC_Age_T1"))
pred %>% group_by(PHC_Diagnosis) %>% summarise(mean=mean(diff))
pred %>% group_by(PHC_Diagnosis) %>% summarise(mean=mean(realdiff))

adni=read.csv("../../scripts/different_model_predictions.csv")
adniall=read.csv("../../data/ADNI_FS_2024_V2.outlier.csv")
adni=inner_join(adni,adniall)
adni=subset(adni,outlier==0)
ggboxplot(data=subset(adni,outlier=="0"),x="DX",y="realdiff")
realdiff=subset(adni,outlier==0)%>%group_by(DX)%>%summarise(mean=mean(realdiff))
diff=subset(adni,outlier==0)%>%group_by(DX)%>%summarise(mean=mean(diff))

test=read.csv("../../scripts/test_predictions_different.csv")
testall=read.csv("../../data/combined5.outlier2.csv")
test=inner_join(test,testall)
subset(adni,&diff<30%>%summarise(mean=mean(realdiff))
test%>%summarise(mean=mean(realdiff))


